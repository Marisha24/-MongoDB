
  [[Тема 1. Введение в noSQL]]

 [[Тема 2. Основы работы с MongoDB]]

  

## Тема 2. Основы работы с MongoDB

### Создание, обновление и удаление документов (CRUD)

Вставка документов

insertMany

Проверка вставки

insert

Удаление документов

drop

Обновление документов

Замена документа

Использование операторов обновления

Upser

Обновление нескольких документов

Возврат обновленных документов

### Выполнение запросов

Знакомство с методом find

Указываем, какие ключи нужно вернуть

Ограничения

Критерии запроса

Условные операторы

Запросы с оператором OR

$not

Запросы для определенных типов

null

Регулярные выражения

Запросы элементов массива

Запросы по вложенным документам

Операторы $where

Курсоры

Ограничения, пропуск и сортировка

Избегайте больших пропусков

Бесконечные курсоры

  

## Тема 3. Индексы

  

### Индексы

Знакомство с индексами

Создание индекса

Знакомство с составными индексами

Как MongoDB выбирает индекс

Использование составных индексов

Как операторы с символом $ используют индексы

Индексирование объектов и массивов

Кардинальность индекса

Вывод explain

Когда не стоит прибегать к индексированию

Типы индексов

Уникальные индексы

Частичные индексы

Управление индексами

Идентификация индексов

Замена индексов

### Специальные типы индексов и коллекций

Геопространственные индексы

Типы геопространственных запросов

Использование геопространственных индексов

Составные геопространственные индексы

Индексы 2d

Индексы для полнотекстового поиска

Создание текстового индекса

Поиск по тексту

Оптимизация полнотекстового поиска

Поиск на других языках

Ограниченные коллекции

Создание ограниченных коллекций

Настраиваемые курсоры

Индексы TTL

Хранение файлов с помощью GridFS

Начало работы с GridFS: mongofiles

Работа с GridFS из драйверов MongoDB

Что под капотом

  

## Тема 4. Знакомство с фреймворком агрегации

Конвейеры, этапы и настраиваемые параметры

Начало работы с этапами: знакомые операции

Выражения

$project

$unwind

Выражения массивов

Аккумуляторы

Использование аккумуляторов в этапах с $project

Знакомство с группировкой

Поле _id в этапах $group

Сравнение $group и $project

Запись результатов конвейера агрегации в коллекцию

  

## Тема 5. Транзакции

Знакомство с транзакциями

Определение ACID

Как использовать транзакции

Настройка ограничений транзакций для вашего приложения

Ограничения на размер журнала операций и ограничения по времени

## Тема 6. Разработка приложений

Аспекты проектирования схем

Шаблоны проектирования схем

Нормализация и денормализация

Примеры представления данных

Кардинальность

Друзья, подписчики и другие неудобства

Оптимизация манипулирования данными

Удаление старых данных

Планирование баз данных и коллекций

Управление согласованностью

Перенос схем

Управление схемами

Когда не стоит использовать MongoDB

## Тема 7. Репликация

  

### Настройка набора реплик

Знакомство с репликацией

Настройка набора реплик, часть 1

Пара слов касательно работы в сети

Вопросы безопасности

Настройка набора реплик, часть 2

Наблюдение за репликацией

Изменение настройки набора реплик

Проектирование набора

Как работают выборы

Параметры конфигурации членов

Приоритет

Скрытые члены

Арбитры

Построение индексов

### Компоненты набора реплик

Синхронизация

Начальная синхронизация

Репликация

Работа с устареванием данных

Тактовые сигналы

Состояния членов

Выборы

Откаты

Когда откаты не работают

### Подключение к набору реплик из своего приложения

Как ведет себя соединение типа «клиент к набору реплик»

Ожидание репликации при операциях записи

Другие параметры для "w"

Гарантии специализированной репликации

По одному серверу на каждый центр обработки данных

Гарантия большинства нескрытых членов

Создание других гарантий

Отправка операций чтения на вторичные узлы

Соображения по поводу согласованности

Вопросы нагрузки

Причины чтения с вторичных узлов

### Администрирование

Запуск членов в автономном режиме

Конфигурация набора реплик

Создание набора реплик

Изменение членов набора

Создание более крупных наборов

Принудительное переконфигурирование

Управление состоянием членов

Превращение первичных узлов во вторичные

Предотвращение выборов

Мониторинг репликации

Получение статуса

Визуализация графика репликации

Циклы репликации

Отключение цепочки

Расчет величины отставания

Изменение размера журнала операций

Построение индексов

Бюджетная репликация

  

## Тема 8. Шардинг

  

### Знакомство с шардингом

Что такое шардинг?

Разбираемся с компонентами кластера

Настройка кластера на одной машине

### Конфигурирование шардинга

Когда использовать шардинг

Запуск серверов

Конфигурационные серверы

Процессы mongos

Добавление шарда из набора реплик

Добавляем емкости

Шардинг данных

Диапазоны чанков

Расщепление чанков

Балансировщик

Сличения

Потоки изменений

### Выбор ключа шардинга

Подводя итоги использования

Иллюстрация распределений

Монотонно возрастающие ключи

Случайно распределенные ключи

Ключи с привязкой к местоположению пользователя

Стратегии

Хешированные ключи шардинга

Хешированные ключи шардинга для GridFS

Стратегия «пожарного шланга»

Несколько хот-спотов

Правила и рекомендации

Ограничения

Кардинальност

Управление распределением данных

Использование кластера для нескольких баз данных и коллекций

Ручной шардинг

### Администрирование шардинга

Просмотр текущего состояния

Получение сводки с помощью функции sh.status()

Просмотр информации о конфигурации

Отслеживание сетевых подключений

Получение статистики о соединениях

Ограничение числа соединений

Администрирование сервер

Добавление серверов

Смена серверов в шарде

Удаление шарда

Балансировка данных

Балансировщик

Изменение размера чанков

Перемещение чанков

Неразделимые чанки

Обновление конфигураций

  

## Тема 9. Администрирование приложений

  

### Смотрим, что делает ваше приложение

Просмотр текущих операций

Поиск проблемных операций

Ложные срабатывания

Предотвращение фантомных операций

Использование системного профилировщика

Вычисление размеров

Документы

Коллекции

Базы данных

Использование утилит mongotop и mongostat

### Обеспечение безопасности в MongoDB

Аутентификация и авторизация в MongoDB

Механизмы аутентификации

Авторизация

Использование сертификатов x.509 для аутентификации членов и клиентов

Руководство по аутентификации в MongoDB и шифрованию на транспортном уровне

Создание центра сертификации

Создание и подпись сертификатов членов

Генерация и подписание клиентских сертификатов

Создание набора реплик без включенной аутентификации и авторизации

Создание пользователя с правами администратора

Перезапуск набора реплик с включенной аутентификацией и авторизацией

### Долговечность

Долговечность на уровне членов с помощью журналирования

Долговечность на уровне кластера при использовании гарантии записи

Опции w и wtimeout для параметра writeConcer

Опция j (ведение журнала) для параметра writeConcern

Долговечность на уровне кластера при использовании гарантии чтения

Долговечность транзакций с использованием гарантии записи

Чего MongoDB не гарантирует

Проверка на предмет наличия повреждений

## Тема 10. Администрирование сервера

  

### Настройка MongoDB в рабочем окружении

Запуск из командной строки

Конфигурирование на базе файлов

Остановка MongoDB

Шифрование данных

SSL-соединения

Протоколирование

### Мониторинг MongoDB

Мониторинг использования памяти

Знакомство с памятью компьютера

Отслеживание использования памяти

Отслеживание отказов страницы

Время ожидания ввода/вывода

Вычисление рабочего множества

Примеры рабочего множества

Отслеживание производительности

Отслеживание свободного пространства

Мониторинг репликации

### Создание резервных копий

Методы резервного копирования

Резервное копирование сервера

Снимок файловой системы

Копирование файлов данных

Использование mongodump

Особые факторы при копировании наборов реплик

Особые факторы при копировании разделенного кластера

Резервное копирование и восстановление всего кластера

Резервное копирование и восстановление одного шарда

### Развертывание MongoDB

Проектирование системы

Выбор носителя для хранения

Рекомендуемые уровни спецификации RAID

Центральный процессор

Операционная система

Объем подкачки

Файловая система

Виртуализация

Избыточное выделение памяти

Таинственная память

Обработка проблем ввода/вывода сетевого диска

Использование несетевых дисков

Конфигурирование настроек системы

Отключение архитектуры неравномерного доступа к памяти

Упреждающее чтение

Отключение THP

Выбор алгоритма планировани

Отключаем отслеживание времени доступа

Изменение ограничений

Конфигурирование сети

Наводим порядок в системе

Синхронизация часов

OOM Killer

Отключите периодические задачи